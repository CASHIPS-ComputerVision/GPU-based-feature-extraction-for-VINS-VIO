/**
* This file is part of MultiCol-SLAM
*
* Copyright (C) 2015-2016 Steffen Urban <urbste at googlemail.com>
* For more information see <https://github.com/urbste/MultiCol-SLAM>
*
* MultiCol-SLAM is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* MultiCol-SLAM is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with MultiCol-SLAM . If not, see <http://www.gnu.org/licenses/>.
*/

/*
* MultiCol-SLAM is based on ORB-SLAM2 which was also released under GPLv3
* For more information see <https://github.com/raulmur/ORB_SLAM2>
* Raúl Mur-Artal <raulmur at unizar dot es> (University of Zaragoza)
*/

#ifndef MDBRIEFEXTRACTOROCT_H
#define MDBRIEFEXTRACTOROCT_H

#include <vector>
#include <list>
#include <opencv/cv.h>
#include <opencv2/opencv.hpp>

#include <opencv2/core/cuda.hpp>
#include <opencv2/cudafilters.hpp>

#include "cam_model_omni.h"
#include "cuda/Fast.hpp"
#include "cuda/Orb.hpp"
//#include "cam_system_omni.h"

namespace MultiColSLAM
{
#define CAMS 3

	//static int learned_pattern_64_[4 * 512] = 
	//{
	//	-11, 0, 11, -1, -8, -6, -4, -2, 10, 12, 12, 15, -2, 2, -1, -1, -2, 14, 2, -13, -3, -14, 0, 6, -13, 12, -3, -6, 12, -10, 15, -12, 1, 10, 3, -7, -13, -7, -6, -12, -6, -10, -3, 13, 8, 7, 8, 13, 1, -7, 2, -2, -11, 6, -7, 9, 3, 15, 9, -13, 7, -13, 9, -10, -3, 7, -2, 4, -12, 14, -11, 10, -7, -1, -5, 4, -6, 12, -4, 15, 15, 6, 15, 10, 11, 4, 15, -14, -8, -14, -4, -13, 4, 2, 6, -2, 6, 12, 13, 11, 0, 3, 2, 6, 13, 3, 15, 6, 6, 3, 6, 7, -13, -9, -13, -5, -14, 8, -13, 5, -7, -14, -7, -10, 8, -9, 13, -6, -13, 15, -10, 13, 4, -3, 7, -6, -14, -4, -13, -1, 7, 1, 11, 1, 12, -2, 15, -1, 2, -11, 5, 14, -14, -14, -10, -11, -13, 1, -9, 3, -13, 4, -12, 1, 10, 5, 11, 0, -6, 14, -4, 10, -4, 15, 1, -4, -6, 7, -1, -12, -1, 5, 5, -11, -7, 8, -3, 9, 2, -12, 5, -11, 1, 10, 3, 7, -4, -3, -2, -6, -3, -14, 0, -13, 2, 8, 13, -10, -1, -3, 1, 2, 14, -10, 15, -13, 3, 2, 8, 4, 6, 12, 9, -5, 3, 15, 8, 13, -2, -8, 2, 14, 5, -11, 7, 0, 12, 13, 15, 15, 1, -6, 6, 10, 15, 11, 15, 15, -12, -1, -8, 15, -9, 4, -6, 2, 3, 4, 4, 1, -8, -2, -6, -6, -4, -4, -3, 0, 6, -4, 9, -1, 8, -7, 9, -12, -13, -13, -11, -8, -13, 5, -9, -14, -10, 12, -7, 14, 7, -1, 13, 15, 3, -4, 4, 15, 2, -14, 3, 9, -7, -12, -4, -7, -11, -1, -8, -3, -8, 15, -5, 14, -3, 2, -2, 5, 1, 15, 2, 12, -13, -10, -6, 8, 14, -1, 15, 2, -6, 4, -5, 10, 1, -11, 3, -14, -2, 10, -1, -8, 6, 6, 9, 8, -14, -8, -11, -6, -1, -11, -1, -4, 6, -13, 9, -14, -9, -3, -9, 1, 11, -7, 13, -2, 12, 11, 15, -7, 9, 7, 14, 5, 4, 11, 7, 15, 10, -1, 13, -4, 3, 6, 4, 10, -14, 7, -13, 10, 9, -3, 9, 1, -10, 10, -8, 7, -7, 7, -1, -1, -9, -10, 0, 9, -13, -4, -2, 4, -9, 15, 2, -10, -6, -4, -2, -4, -2, -6, 1, -4, 0, 15, 6, -8, -1, 6, 2, 2, -2, -13, 4, 12, -5, -6, 1, -11, -14, 2, -2, -10, -1, -3, 4, -6, -4, 10, 1, 7, -2, 10, 14, 15, 2, -12, 8, 8, 2, -5, 5, -4, 3, 10, 8, 4, 4, 15, 15, 1, -7, -2, -2, 15, -8, 2, -4, 7, 2, -4, 14, -4, -3, -11, 0, -7, -3, 14, 2, 15, -1, 8, 2, 10, 4, 6, 10, 0, 1, -1, 5, 3, -6, 1, -4, -2, 2, -10, 4, -6, 13, 9, 15, 12, -1, 0, 1, -3, -9, -7, -5, -7, -8, 10, -3, 4, 5, -8, 8, -7, -3, -5, 0, 9, 10, -11, 11, -14, -3, 6, -1, 9, 13, -7, 14, -10, 6, -14, 15, 6, -7, -3, -4, -14, 1, 11, 5, -13, -1, 12, 0, 0, -5, -11, -3, -14, 10, 5, 10, 9, 0, -1, 11, -14, 4, -14, 5, -10, 4, 7, 7, -7, 2, 8, 6, 12, 1, -10, 2, 5, 7, 15, 9, 11, 12, -4, 14, -7, 6, -9, 6, 15, 3, -2, 13, 8, 4, -7, 6, 4, 1, -7, 3, -10, -5, -8, -3, 7, -8, 13, -4, -14, 4, 9, 4, 13, -14, -7, -6, -3, 6, 4, 12, -5, 0, -14, 1, -11, -8, 8, -7, 13, -1, 10, 1, 15, 10, 11, 12, 8, 6, 6, 8, -14, -13, 15, -11, -7, -14, 11, -11, 8, 0, 14, 1, -8, -7, -5, -6, 11, 8, -4, 9, -8, 10, 7, 13, 10, -1, 13, 0, 7, -12, 3, -9, 7, 7, 0, 7, 4, 9, 3, 10, 6, -14, 10, -10, 13, 11, -14, 13, -11, -8, 8, -6, -9, -2, -13, -1, 12, 7, -7, 11, 6, -6, -12, -4, 2, 14, 0, 15, -5, -14, -14, -9, 0, -10, -11, -7, -10, 7, -7, 10, -8, 12, 4, 15, 3, -14, -1, -13, 2, -10, 9, -9, 2, -4, 8, -3, -4, 2, -2, 3, 9, 2, -1, 3, -4, -7, 15, -4, -2, -14, -5, -9, -7, -14, 6, -11, 4, 9, -11, 13, -14, -10, 15, -8, 12, 9, -11, 12, 15, 11, -7, 15, -7, 13, 3, 15, -1, -14, 1, -13, -2, -10, -2, -9, 6, 12, 7, 13, 4, -14, -2, -11, -1, -11, -2, -10, -6, -2, 3, -1, -9, 5, -5, 8, 11, 5, -10, 6, 10, 5, -11, 7, -14, 9, -1, 13, 4, -13, -8, 1, -2, -12, 7, 1, -7, -4, -13, 4, 4, -5, 9, 4, -11, -6, -11, 7, -11, -14, 15, 2, 0, -14, -4, 3, -14, -6, -5, 0, 2, -5, 5, 2, -5, -9, 4, -1, 4, -3, 7, 11, -12, 0, 9, 8, -7, -2, -13, 15, 8, -1, 6, 8, 6, -11, 1, -2, -3, -2, 14, 15, -9, -1, 12, 5, -3, -6, 2, 1, 8, -2, 0, 3, 1, -3, -9, 3, 9, -11, -8, 0, 15, -8, 10, 2, 12, 1, -14, 11, -5, -5, -1, 5, 15, -3, 14, 7, 10, 0, 2, 10, -4, -3, -9, 8, 15, -11, 3, -2, 12, 1, -7, 11, 5, -8, -8, -1, -9, -3, 11, 2, -7, -14, 7, -2, 1, -1, -3, 10, 10, 0, 5, 5, -4, -5, -9, -1, -1, -14, 11, 0, -14, -7, 0, -4, 1, -10, -5, -3, 10, -11, -14, -1, 3, 1, 5, 15, 2, 13, 12, 15, 15, 3, 15, 7, -3, -1, -8, 2, -9, -6, -14, 1, 13, -7, -12, 0, -14, -6, 9, -1, -7, -5, -1, -2, 4, 1, -7, 9, -9, -6, 5, 0, 15, 0, -14, 3, -1, -1, -14, 3, -12, 3, 15, 8, 7, -8, 4, -3, -8, -13, 14, -1, 15, -4, 0, -2, -3, -14, -11, -2, -14, 4, -9, 12, -1, -6, 15, 0, 4, 3, -2, 8, -1, -14, -14, -12, -11, -3, -8, 0, 5, -14, 3, -4, 6, 3, 9, 8, 9, -8, -6, -4, -10, -11, 13, -2, 8, 7, 15, 10, 1, -1, 9, 1, -3, 3, 11, 7, -9, 8, -14, 11, -3, -2, -11, 1, -13, 1, 15, 3, 2, -13, 0, -5, 0, -1, 8, 2, -9, 2, -4, 4, 0, 12, 5, 12, 15, -4, 1, 1, -14, -1, 2, 6, 11, 4, 12, 15, -7, 5, 9, 12, 5, -4, 15, 0, 12, -14, 10, -4, 11, 0, 13, 5, 15, -3, 5, -2, 1, 2, 8, 3, 5, -10, 5, -5, -4, -9, -3, -6, -4, -5, 13, -1, -11, 4, -12, 14, -10, 13, -2, 14, 15, 4, 9, 6, -2, 7, 10, 13, -1, -8, -4, -5, 2, 2, 4, 9, -9, -6, 13, -3, 12, 2, -12, 10, 15, -3, -1, 1, 11, 3, 6, 4, 3, -11, -14, -11, -10, -13, 15, -12, 5, -12, -1, -7, -10, -2, -10, 0, 9, 5, 1, 9, -1, 3, -4, 8, 6, 4, -6, 5, -3, -10, -14, -10, -4, 3, -1, 6, -4, 0, -4, 3, 7, 8, 10, 9, 15, -12, -12, -5, 15, 3, -8, 15, 11, -10, 1, -7, 3, -2, 9, 1, -14, 6, 4, 6, 11, 3, 14, 4, -8, 5, -14, 5, -4, 3, 5, 7, 8, 3, -13, 7, -14, 1, -12, 2, -8, -14, -12, -14, -8, -10, 8, -6, 7, -8, -14, -3, 9, 2, 8, 5, -10, 0, -5, 6, 15, 8, 15, 12, -9, 9, 15, 13, 10, 5, -6, 15, 3, -2, -4, 0, -8, 8, -9, 10, 1, 5, 3, 11, 5, 3, 1, 14, -8, 6, -2, 10, -3, 2, 15, 4, -12, 13, -14, 15, -3, 9, -3, 10, 10, 1, 1, 12, 13, -6, 8, -4, 1, 3, 3, 4, -14, 0, -9, 2, 11, -10, -11, -8, -14, 4, 15, 5, 11, -5, 8, -4, 11, -3, 4, -2, 7, -4, -7, -3, -10, 0, 3, 0, 7, 12, 1, 15, 3, 12, -13, 12, -8, 12, 11, 15, 12, -9, 15, -8, 3, 5, 12, 9, 13, 2, 5, 4, -7, 5, 10, 10, -11, 0, -12, 2, 14, 14, 1, 14, 5, -14, -10, -13, 1, -6, -4, -5, -7, -11, -8, -6, 1, 2, -1, 7, 9, -7, -11, -7, -7, -14, 11, -13, -1, -2, -7, 0, -13, 4, 0, 7, 15, 9, -6, 15, -12, 6, -1, 9, 2, 9, -14, 11, 9, 4, -14, 6, 12, -4, 13, -2, -6, -11, 4, -8, 3, 1, 0, 1, 4, 7, 15, 10, 14, -14, 12, -5, 2, 12, -5, 15, 9, 1, 0, 5, -9, 6, 0, 11, -14, 8, 6, 9, 2, -14, -4, -9, 10, -9, 5, -8, 9, -14, 4, -8, -6, -5, -8, -4, -5, -11, -14, -9, -11, -1, -5, -1, -1, 4, -6, 4, 9, -6, 3, -5, 0, -2, 8, -1, 11, 4, 7, 15, 13, 3, -9, 3, -4, 0, 5, 0, 9, 8, -4, 11, -3, -13, 7, -8, 7, 0, 1, 1, -12, 11, -9, 11, -5, 8, -7, 8, 9, -14, -13, -11, 8, -3, -13, -2, -9, 4, -8, 7, -11, -8, 1, -7, 7, -9, 11, -9, 15, 0, 11, 1, -11, 8, 2, 15, 9, 13, -3, 14, 0, -2, -10, -1, 15, -13, -7, -11, -3, 14, 12, 15, 8, 0, 4, 3, 14, 9, -14, 13, -14, -14, 12, -11, 11, -2, -4, 0, 15, -4, 11, -3, 8, 4, -3, 4, 5, 6, -1, 7, -7, -4, -2, -3, 11, -10, -9, -7, -6, 3, -10, 3, 11, -13, 1, -9, -1, -14, 14, -7, 10, 5, 5, 10, 15, 8, 2, 9, -1, -11, 6, -8, 0, -4, 13, -3, 2, -14, -10, -12, -13, -14, -13, -9, -8, -14, -10, -11, -9, 9, 7, 15, -4, 9, 4, 13, 1, -6, -4, -6, 0, 12, -11, 15, -9, -7, -14, -5, -11, 11, -9, 14, 5, -12, -3, -9, 1, -4, -2, -4, 3, -14, -14, -9, -13, 9, -4, 12, 0, 10, 14, 13, 15, -9, 15, -5, -8, 2, 3, 4, 8, -8, -10, -7, -3, -14, -6, -14, 5, 0, -5, 0, 6, 1, -5, 2, 12, 8, 6, 12, 7, 8, 5, 10, -9, 7, -1, 15, -2, 3, 1, 4, 4, 15, -8, 15, -4, -14, 15, -10, 15, -3, -8, -3, -2, -14, -2, -13, -5, 8, 11, 11, 13, 6, 0, 7, -3, -14, 2, -13, 5, 4, -5, 6, -9, 6, 0, 9, 7, 2, -2, 2, 2, 8, -1, 10, -4, -14, 5, -11, 6, -10, 2, -9, -1, 11, 4, 12, -5, 12, 9, 15, 8, 2, 12, 3, 15, -11, -14, -8, -12, -6, -5, -6, 6, 9, -5, 13, -6, -14, -4, -12, -7, -8, -11, 5, 8, -11, 10, 6, -10, -14, -6, 3, 5, -10, -6, 4, -8, -5, 12, 6, -7, -11, -9, 15, -12, -7, 2, 6, -12, -8, 3, 1, -1, -5, 7, 5, 4, -4, -7, 5, 0, -14, 1, 3, 10, -7, 7, 15, 11, -7, -8, 5, 13, -6, -14, 7, -5, -14, 0, 0, 1, -4, -4, 9, -8, -13, 5, 8, 15, -2, -10, 8, 7, -3, 4, 7, -6, -4, -12, 15, -4, -10, 0, 1, -9, -7, -5, 2, 9, -4, 13, 15, 3, -8, 10, 2, -4, -5, -2, 3, -4, -5, -13, 8, 12, -1, 15, 9, -4, -9, -3, 2, 14, -1, -7, 10, -3, -4, -1, 6, 8, -9, 6, 2, -13, -9, 14, 5, 7, -4, 15, 6, 2, 0, 9, 10, 0, -2, 13, 8, -10, -7, -10, 2, -5, -2, 1, 12, 4, 0, -12, 8, 1, -13, -5, 0, 10, -14, 7, 1, 6, -1, -3, 8, 1, -14, -3, 0, -6, -4, 3, 0, 3
	//};

	static int learned_pattern_64_ORB[4 * 512] =
	{
		-12, -1, 11, 0, 11, 1, 11, 15, -9, -14, -9, 3, -1, -1, -1, 10, 9, -9, 15, -14, 2, -12, 2, 14, -5, -8, -2, -1, -11, -10, -3, 10, -7, 4, -4, -2, -2, -14, 1, 9, 0, 4, 2, -3, -14, 12, -3, 5, 9, 4, 10, -14, -1, 12, 2, -13, -5, 14, -1, -7, -11, 8, -7, 14, 6, 15, 7, 7, 7, -14, 8, -8, -13, 15, -12, 7, 3, 10, 7, -11, -10, -8, -8, -14, 1, -5, 2, 2, 4, 2, 8, -4, -14, -5, -7, -8, 4, -4, 4, 12, 8, 12, 12, -6, -13, 0, -13, 14, 5, -10, 15, 12, 13, -11, 13, -3, -14, 2, -13, -13, -4, 3, -3, -10, 5, 0, 9, 5, 13, -2, 15, 4, -14, -14, -10, -9, -14, 6, -13, 0, 8, 5, 14, 3, -7, 9, -6, 1, -4, -4, -4, 3, -9, 10, -1, -1, -8, -7, -1, -5, -8, 8, 0, -14, -6, -12, 4, -13, -4, -8, 1, 5, -14, -4, -2, 2, -1, -11, 4, -3, -9, 5, -2, 7, -3, 7, 2, -8, -14, 4, -2, -5, -2, 15, 4, -9, -1, 4, 9, -11, -6, -5, 0, 14, -7, 14, 3, 15, 2, -14, 7, 7, 1, 15, 11, -10, -1, -7, 4, 10, -9, -3, -3, -9, -1, 12, 9, 14, -3, 2, 1, 7, 3, 10, 7, 3, 1, 1, 7, 3, 2, 6, 12, 7, -11, 11, -2, 15, 3, -6, 9, -5, -1, 7, 1, 0, -7, -2, -3, 5, 5, 14, 14, 0, -12, 1, -5, 10, 1, -14, 7, -13, -8, -10, -3, -14, -3, -12, 2, 15, 4, 7, 9, -2, -1, -4, 3, -9, 4, -13, 14, -8, -6, 5, -3, 11, 1, 11, 3, -6, -3, 9, -1, 3, 11, -8, 12, -14, 8, -14, 12, 4, 8, 8, 8, 15, -4, -14, 0, -8, 2, 0, 15, -3, 4, 14, 6, -7, -11, 14, -3, -11, 5, -5, 10, 1, 13, -3, 15, -12, -9, -6, -6, 15, 5, -9, 7, -2, -12, -13, -12, -6, -11, -7, -5, -5, 11, 10, 15, 15, 7, -6, 7, 15, -9, 0, -6, -6, 6, 3, 6, 12, -7, -13, -2, 5, -5, -3, -3, -13, 2, 0, 2, 15, -3, -7, -1, 10, -4, 9, -2, 15, 6, -5, 7, -14, 3, -8, 7, 10, -14, -13, -5, -12, -9, -14, -3, -10, 3, -3, 5, 3, 10, 13, 11, 4, 2, 3, 7, 9, 1, -7, 7, -14, -6, 15, -2, 10, 11, 5, 15, 10, -8, 4, -7, -14, -14, -11, -14, 0, 2, -10, 3, 6, 5, 14, 11, 15, -6, -12, -3, 14, -1, 14, 0, -3, -7, -14, -7, -7, -12, 15, -11, -4, 0, 8, 4, 15, -13, 2, -7, 3, 1, -14, 1, 1, -3, 13, -1, 7, -14, 10, -13, 4, 13, 0, 15, -6, 8, -1, 8, 9, 3, 0, 3, 7, 2, 7, 4, -8, 9, 15, 14, 11, 2, -3, 15, 15, 4, 4, 5, -13, -2, -8, 0, -14, 0, 0, 3, -6, 11, -6, 15, 14, -9, -4, -6, 3, 15, 1, 15, 9, 2, 13, 3, -10, 4, 6, 13, -10, 12, -14, 13, -8, -8, 15, -7, 8, -13, -5, -8, 9, 8, -8, 13, -4, 4, -11, 10, -14, -6, 9, -4, -8, 6, -2, 7, -9, -13, 15, -7, 13, -3, 6, -2, -4, 4, -14, 7, 14, -5, -2, -4, 10, -4, 14, -2, -14, -2, -2, -1, 4, -14, 8, -7, -8, 7, -9, 7, 4, -5, -10, -5, -3, -2, 10, -1, -10, 6, 15, 9, -13, 1, -6, 1, 12, 6, -4, 12, -6, -1, 5, 1, -14, -14, -10, -10, -5, -8, 4, -8, 11, 9, 8, 10, 1, 3, -8, 4, 15, 14, 10, 15, -14, 14, 12, 15, -1, -14, 0, -9, -4, -14, -5, -12, 1, 6, 9, 7, -7, 10, 1, 15, -3, 3, -6, 3, 8, 9, -11, 9, 13, 6, -4, 6, 6, -6, -10, -6, 9, 14, 4, 15, -2, 8, -5, 12, 5, 9, 2, 14, 6, 5, 7, 11, 12, -14, -14, -11, 11, 8, 4, 11, -3, -1, 5, -1, 12, 13, -7, 13, 1, -2, -8, -2, 15, 4, -11, 4, 11, 0, -10, 0, 11, -10, 5, -8, -1, 9, -2, 15, 0, -14, -1, -14, 6, 0, -7, 0, 7, -8, -12, 6, 7, -8, 8, 5, -11, -9, -8, 8, -10, -11, 8, 3, -5, -11, -7, 2, 0, -10, 15, 7, -8, -8, 4, 1, 2, -4, 3, 7, -7, -13, -6, 3, 9, -9, -10, 15, 15, -6, -4, 3, -4, -5, 10, 11, -11, -12, 2, 0, -2, -3, -9, 6, 3, -5, -3, 4, 6, -13, 3, 2, -10, -6, 12, 9, 9, -3, -13, 11, 7, -3, 11, 6, -5, -5, -11, 14, -6, -10, -2, 5, -14, -5, -6, 8, 13, -9, 2, 2, 10, -4, 6, 3, -1, -11, 0, 0, 5, -2, 5, 9, 5, -14, 12, 3, 4, -8, -2, -1, 1, -2, -5, 9, -5, -13, 11, 11, 15, -4, -1, 15, 10, -14, -14, 4, -5, -5, -9, 3, 10, -8, 14, 3, -1, -12, -9, 5, 15, -7, 1, 1, -6, -12, -2, 2, 15, -9, -9, 1, 6, -1, -8, 14, 3, -1, 15, 10, -4, -5, 7, 3, 8, -4, -12, 6, 12, -3, -4, 2, 0, -12, -3, 0, -7, -2, 9, 6, -10, -4, -11, 5, -7, -8, 12, 2, -9, 0, 8, 10, -2, -13, 9, 3, -14, -5, 14, 6, -12, -6, -14, 3, 0, 0, -13, 9, 0, -9, -4, 0, 10, -6, 4, 6, 15, -1, -10, 6, 9, -8, 6, 0, -9, -3, 9, 3, 4, -1, 2, 13, -1, -5, -1, 3, -10, -10, -7, 1, -11, -14, 7, 1, 9, 0, 11, 9, -8, -10, -10, 1, 11, -12, 7, -1, 2, -4, -7, 3, -9, -6, 3, -1, -2, 0, -4, 9, 3, -4, 10, 3, -12, -2, 5, 15, -9, -4, -3, 9, -13, -3, -14, 4, 6, -3, 15, 6, 5, -7, 8, 0, 6, -14, -2, 0, -14, -4, 5, 6, -14, -1, -2, 5, -1, -5, 9, 1, -5, -2, 14, 15, 7, -14, 0, -1, 10, -5, 15, 3, -6, -8, 1, 0, -12, -5, -7, 0, -3, -1, -14, 10, -8, -1, -9, 11, 12, -9, 7, 1, 15, -1, 4, 5, -3, -11, 15, 1, -5, -10, -10, -1, 1, -7, 14, 3, 8, -5, -8, 3, 15, -8, -14, 3, 13, -14, -7, -1, -3, -3, -1, 6, 11, -14, 10, 0, -8, -5, 6, -1, 1, -4, -13, 10, -14, -1, 11, 4, 0, -14, 15, 2, 12, -1, 8, 5, 9, 1, -8, 7, -3, 1, 12, 9, 6, -9, 2, -3, 1, -6, -10, 1, -8, -2, -9, 6, -11, -2, 7, 14, 14, -13, -6, -1, 13, -5, -3, -1, 3, -2, 11, 3, -8, -12, -4, -2, 7, 0, 7, 6, -7, -10, -2, -3, -2, -12, 4, -2, -14, 1, 11, 15, -2, 0, -7, 5, 6, -1, -8, 14, -11, -2, -14, 11, 15, -11, 2, -2, 14, -2, -9, 2, 2, -14, 4, -2, 5, -6, 1, 1, 14, 2, -9, 8, 3, -6, 1, -1, 7, 1, -7, 9, 8, -4, -4, 2, 11, -7, 13, 2, -14, -7, 12, 0, 3, -6, 10, 0, 11, 0, 2, 8, -4, -9, -6, -2, 4, -3, 11, 3, 12, -5, -6, 0, 8, 0, 14, 5, -6, 2, -14, 14, 4, 2, -10, 12, -4, -1, 0, 11, -8, -1, 12, 9, -13, -5, -12, 1, 7, 2, 4, 8, 2, -8, -10, 0, 15, -6, -5, 1, -14, -1, 8, 3, -4, -2, -1, 3, -5, 2, 12, 7, -3, -9, 7, -2, -5, -9, 0, -3, -5, -9, -13, 0, -4, 3, 15, 9, 2, -14, 1, -3, 0, 0, 13, 6, 10, -2, -9, 6, 15, -4, 11, 0, -1, -14, 0, -3, -9, 0, -14, 6, 11, -2, -14, 4, -11, -2, -10, 3, 12, 3, 13, 11, -6, -1, 3, 9, 11, -11, -10, -1, -8, 0, -1, 11, 7, -3, 6, 2, 11, -10, 11, -1, 8, -4, 4, 1, -11, -4, -6, -1, 1, -11, -14, 1, -14, -8, -5, -3, -1, 1, -6, 4, 0, 1, 12, 6, -10, -5, -10, 0, 12, -14, -7, -2, -11, -3, 3, 1, -5, -7, -10, -1, 9, 2, 7, 11, -6, -1, 4, 4, 8, -8, -7, -2, 12, 2, 7, 6, -1, 3, 9, 12, 3, -6, 10, -1, -10, -11, 6, -3, -9, 1, -5, 15, -5, -1, -4, 11, 14, 2, -12, 11, 10, -12, 6, -3, 11, 3, -12, 8, -6, 1, 8, 8, 10, -3, -11, 1, -6, -4, 9, 2, 15, 1, -6, 8, -9, 0, 8, 14, -14, -9, -3, -3, 15, -11, -4, -4, -14, 1, -12, 4, 3, -2, -5, 2, 7, -4, 13, 1, -10, -1, 0, 4, 5, -6, 3, -2, -6, -14, -2, -4, 15, -2, 15, 5, 14, -10, 1, -4, 4, 2, -2, 9, -2, 1, -13, 5, -7, -1, 4, 4, -8, -8, -1, -3, 9, -1, 15, 2, 0, 1, -5, 15, 8, 5, -13, 11, 0, -3, -9, 2, -13, 2, 5, 15, 1, 1, 15, 12, 13, -1, -9, 2, 7, 2, 1, 11, 2, 2, 15, 6, 7, -1, 10, 5, -14, -1, 15, 6, -14, 1, 11, 4, 5, 3, -14, 6, -1, -7, -6, -3, -11, 4, 15, 12, 8, 4, -10, 11, 6, 2, -3, 14, 1, 5, 15, 9, -3, -6, 15, -1, -1, -6, -14, 0, -12, -11, 5, -4, -2, -1, 8, 3, -11, -3, -11, 0, -2, 2, 10, 15, -9, -8, 8, -3, 4, -4, -13, 0, 3, 3, 10, 7, -6, -13, 15, -2, 1, 0, -2, 5, -6, -14, -3, -4, -5, -1, 15, 3, 9, -2, -4, 5, 15, 3, 3, 11, -2, -2, 12, 1, -5, 2, 5, 6, -4, -14, 0, -6, -14, -7, 5, -3, -12, 2, 10, 15, 10, -8, 15, -1, 13, 1, -10, 6, 12, 3, -11, 9, -10, -5, -1, -2, -7, -14, -12, -2, 5, 5, 11, 9, 0, -10, 7, -4, 6, -11, 9, -4, -14, 4, -9, 14, 1, -10, 1, -5, -11, 3, 15, 5, -1, -8, 4, -4, 9, -9, -14, -1, 12, -2, 12, 1, 5, -9, 12, -2, -7, -2, 0, 5, -13, -6, -8, -2, 6, 2, 4, 10, -8, -8, 8, -4, 13, 2, 15, 5, -9, -4, 5, -2, -1, -3, -10, 0, 9, 1, 2, 15, 8, -4, 8, -1, -7, -10, 1, -6, 15, 5, 10, 13, -3, 7, 15, 11, 5, -11, -5, -5, 11, -4, -3, -1, -9, 1, -4, 6, 8, -11, -2, -5, 1, -11, -5, -6, -9, -13, -11, -3, 15, -4, 8, -1, -13, -6, 10, -2, -4, 5, 15, 15, -7, -14, 13, -3, 11, -7, 15, -1, -11, 3, -3, 9, 5, -8, -9, -3, -3, -11, 4, -5, 2, 1, 7, 6, -11, 4, 11, 10, -9, -14, 11, -3, -3, 1, -7, 8, 13, -8, 6, -4, 1, -11, -7, -4, 1, 5, -13, 7, 4, 8, -14, 11, -5, -14, 4, -6, 13, -8, -5, -4, 8, 11, 7, 11, 15, -14, -1, -5, 6, 1, -14, 3, 7, -2, 2, 4, 14, 0, -13, 5, 15, 8, -1, 8, 15, 4, -8, 12, -8, -13, 3, -6, -9, -2, -8, 1, 13, -4, 0, -1, 10, 10, -3, 11, -14, -5, -8, -2, 15, 3, -7, 5, 3, 9, 15, 11, -1, 3, -3, 9, -6, -1, -7, 0, -1, 5, -1, 5, 15, 0, -14, 2, -4, -12, 0, -6, -5, -2, 15, 1, -7, 6, -8, 10, -3, 6, 11, 12, 6, -7, -14, -2, -1, 1, 11, 2, -2, 2, -8, 15, 15, 6, 15, 9, -8, 4, -7, 8, 6, 8, 5, 8, 13, 3, 7, 7, -7, 2, -8, 3, -2, -4, -14, 0, 12, 6, 14, 7, 2, 5, 5, 11, 2, 1, -3, 13, -12, -14, -8, -6, -13, 6, -14, 10, 9
	};

	//static int learned_orb_pattern_64_fisheyeOCAM_corr21[4 * 512] =
	//{
	//	-14, -14, -8, 4, -14, 2, -14, 9, -1, -11, 0, 14, 6, 2, 8, 15, 7, 8, 8, -11, 2, -9, 3, -14, -14, 12, -11, 10, 12, -10, 15, -12, -5, 10, -5, 14, 12, 13, 15, 15, -7, 3, -6, 0, -13, -11, -12, -14, -14, -14, -11, -13, 9, -13, 12, -11, 14, 1, 15, 4, -12, 8, -9, 11, -4, -2, -2, 1, 7, 15, 10, 14, -7, -13, -4, -14, 4, 2, 7, 4, -2, -10, -1, -3, 13, 5, 15, 2, 11, -2, 13, -5, 14, -14, 14, -7, -4, 9, -3, 5, 13, -4, 15, -1, 0, 0, 1, 4, 7, 12, 9, 15, 1, 3, 2, 0, 2, 15, 3, 12, -14, -2, -12, -5, -5, -14, -4, -11, 11, 5, 14, 6, -11, -1, -8, 0, -5, -2, -4, -5, -8, 10, -5, 8, 7, 7, 9, 4, 5, -5, 7, -2, 5, -13, 8, -14, 14, 7, 15, 10, 8, -1, 11, -2, 0, -14, 3, -13, -6, 13, -3, 15, -7, 0, -4, -1, 2, 0, 5, -4, -1, 15, 3, 15, -9, 15, -8, -10, 14, 14, 15, -10, -14, 4, -13, -3, 6, -4, 7, -8, -11, 6, -9, 3, 7, -2, 8, 1, 13, 15, 14, 12, 7, 1, 8, 5, -14, 8, -14, 13, 2, 12, 3, 15, -9, 2, -8, 5, -14, -6, -11, -4, 8, -8, 10, -11, -14, 1, -12, 4, -6, -4, -5, -1, 13, 10, 14, 7, 1, 9, 2, 12, -7, -9, -5, -6, -11, -14, -8, -11, -12, -5, -11, -8, 12, -7, 13, -4, 4, -11, 5, -8, 2, 3, 2, 7, -7, -11, -6, -14, -6, 7, -5, 10, 11, 11, 14, 10, -10, 12, -9, 9, 11, -4, 15, -4, -12, -7, -9, -8, 9, 1, 12, 3, 14, -5, 15, -8, -14, -13, -13, -9, 2, 11, 4, 7, -11, 15, -7, 15, 3, -11, 9, 15, 0, -7, 2, -10, 6, 8, 9, 10, 14, -11, 15, -14, -14, -8, -4, 12, -1, 0, 2, 1, -3, -2, 2, 15, 15, 10, 15, 14, 4, 8, 7, 7, -4, 11, 1, -5, -12, 6, -5, -14, 3, 15, 12, -12, 1, -7, 10, -6, 3, -14, 3, 4, 8, -1, 9, -4, 14, -13, 14, 6, 4, -5, 5, 9, 11, 0, 15, 12, -5, -11, -3, 8, -6, 1, -6, 8, -2, -12, -1, -8, 9, 8, 11, 11, 13, 3, 15, -3, -10, 11, -10, 15, -14, 8, -11, 5, 10, -5, 12, 8, -3, 12, -2, 9, -7, -2, -6, 3, -9, 15, -7, 12, -10, 0, -9, -3, -9, 7, -9, 11, 9, 2, 10, -1, 9, 5, 10, 2, 0, -6, 1, 5, 9, -9, 10, -6, -11, 5, -10, 8, -13, -3, -11, 0, 3, 6, 4, 9, -9, -5, -7, -2, 12, 9, 15, 10, -4, 15, -3, 12, -14, 3, -11, 2, 8, -14, 8, -10, -1, -5, 0, -2, 8, 15, 9, 12, -3, 6, -2, 3, 9, 11, 10, 8, 8, 4, 9, 7, 4, -7, 5, -4, 11, 11, 13, 14, 6, 3, 7, 0, 12, 0, 15, 1, -14, 6, -11, 7, -9, -8, -8, -11, 0, 6, 0, 10, 12, -9, 15, -8, -2, 12, -1, 15, 6, 10, 7, 13, 6, -5, 6, 0, 4, 8, 5, 5, -5, 1, -4, -2, 1, -4, 2, -7, -8, 9, -7, 6, -11, 10, -8, 9, -4, -7, -3, -10, 11, 3, 14, 2, 9, -10, 12, -11, -12, 1, -9, -1, -14, 14, -11, 15, -3, 3, -2, 6, -8, -11, -7, -8, 9, 13, 12, 14, -10, -7, -7, -6, -10, 5, -7, 4, 2, 11, 4, -12, -10, 15, -4, -2, -1, 0, 0, -3, -12, -13, -9, -14, 9, -11, 10, -14, -14, -7, -13, -3, -6, -10, -6, -1, -9, -2, -7, -5, 9, -3, 12, -1, -9, 12, -7, 15, 8, -5, 11, -7, 7, 0, 15, -14, -14, 15, -13, 11, -7, 3, -5, 6, -10, -5, -10, -1, -9, 0, -6, 2, 2, -14, 4, -10, -7, 15, -4, 14, -7, -12, -4, -10, 8, -7, 11, -6, -7, 6, -4, 3, 2, -11, 5, -14, 9, 13, 14, -2, 8, 5, 11, 4, 4, 13, 7, 15, 7, -9, 12, 3, -9, 8, -6, 9, 10, 6, 10, 10, -9, -9, -6, -10, -5, -7, -2, -4, -2, -14, 3, 10, -6, -5, -4, -8, -4, 14, -1, 12, 2, -3, 5, 3, -3, 9, -1, 12, -11, -10, -11, -6, 3, 15, 6, 14, -3, -13, 0, -14, 3, -13, 6, -12, 0, 11, 3, 14, 7, 5, 15, -6, 4, -3, 12, 12, 6, 4, 9, 5, 6, -2, 9, -1, 0, -8, 3, -5, -10, -14, 0, 5, -3, 9, 0, 7, -5, 8, -2, 9, -4, 7, 1, -13, -4, -7, -1, -8, -3, 2, 0, 0, 1, 7, 4, 8, 5, 12, 14, 6, -12, 3, -1, 15, -14, -1, -2, -8, 0, -12, 15, 10, -14, 15, 3, -1, -13, -14, 4, -11, -14, -9, -11, 9, -13, -13, -9, -6, -10, 4, -9, -1, 1, -5, 2, 15, -12, 2, -11, 6, -7, 13, -5, 8, -2, -3, -2, 10, 14, 8, 15, -1, -3, -7, -2, 2, 4, -6, 5, -11, 9, -5, 11, -9, -14, 15, -9, 3, 8, -10, 10, 13, 8, -10, 8, 1, -14, 7, -13, 10, -14, 14, -10, -4, 12, 12, 13, 9, 8, -12, 8, -5, 12, -6, 15, -9, -5, 15, -4, -7, -14, -4, -13, -7, 9, -6, 10, -3, -14, -11, -11, -9, -4, 6, -4, 11, 10, 2, 11, -5, 11, 8, 12, 4, -10, -5, -8, 3, 11, 1, 13, 5, 8, -4, 9, -1, -6, 5, -5, 2, -1, 6, -1, 15, 11, -13, 12, -10, -2, -14, -1, -11, -7, 5, -7, 9, 10, 5, 12, 8, -14, 11, -13, 14, 11, 6, 15, 14, -3, -6, -2, -3, -6, -14, -4, -5, 5, 1, 6, 9, 11, 4, 12, 0, 11, -1, 13, 2, -14, 5, -12, 1, -8, -13, -6, -10, -9, -5, -8, 9, 4, 8, 5, 11, -10, -7, -8, -4, 12, -13, 15, -14, 10, -9, 13, -13, 12, 1, 15, -10, -1, 15, 0, 12, -2, 3, -2, 9, -2, 10, -1, 7, -10, -14, -6, 11, 8, -1, 9, 3, -4, -4, -3, 5, 1, -2, 2, 1, 6, 14, 7, -14, -10, 10, -8, 7, -10, 0, -9, 4, 6, -10, 8, -14, 0, -10, 1, -7, -14, -8, -13, -11, 13, -10, 15, -7, 3, -5, 4, -8, -11, 9, -10, 12, 12, 3, 15, 6, -6, 7, -5, 4, -14, 9, -11, 8, -13, 2, -11, -1, -4, -9, -3, -6, 11, -5, 12, -1, -14, 4, -12, 7, -14, -2, -11, -1, 7, -7, 8, -4, 8, -3, 9, -6, 5, -1, 6, 2, 6, 6, 7, 9, -6, 1, -5, 4, -12, 15, -9, 13, 5, -9, 6, -12, 5, -2, 6, -6, 1, -7, 2, -4, 4, -9, 5, 15, -11, -2, -10, -6, -9, 5, -7, 2, 7, 1, 8, -3, 3, -5, 4, -1, -9, 3, -9, 7, -1, -11, 0, -14, -13, 6, -10, 5, 0, 12, 1, 9, 14, -5, 15, 3, -4, 4, -3, 1, 4, 1, 5, 4, -2, -1, -1, 2, -14, 14, -12, -14, 4, 4, 5, -5, 11, -8, 14, -9, -6, 10, -4, 7, -6, -6, -5, -3, 15, -10, 15, -4, -11, -7, -10, -10, -1, -9, 0, -12, 1, 7, 2, -1, 12, -1, 15, -2, -10, -11, -9, -14, -14, -3, -11, -4, -9, 10, -8, 13, 10, -13, 13, -14, 8, -3, 9, 12, 2, -10, 2, -5, 2, -14, 4, 14, 11, 7, 14, 9, -12, 14, -10, 10, -9, -4, -8, -7, -14, -1, -13, 3, -11, -10, -8, -8, -13, 2, -10, 3, 7, -7, 8, -10, -12, -4, -9, -3, -1, 8, 0, 5, 5, 6, 6, 0, -1, 2, -1, 6, -4, -14, -4, 14, 12, 8, 15, 7, -4, -11, -3, -14, 5, 13, 6, 10, 2, -12, 2, -8, 7, 8, 8, 11, -5, 12, -4, 15, -14, 2, -13, -9, 6, 11, 7, 8, 8, 2, 10, 5, 12, 15, 15, 14, 2, 13, 3, 2, 3, 6, 4, 3, 10, 10, 13, 12, -7, 3, -6, -5, -14, 9, -12, 12, -4, 1, -3, 5, 1, 5, 2, 8, 1, 1, 2, -7, -1, 4, 0, -2, -1, -3, 0, 0, 9, 10, 15, -14, -14, -6, -11, -7, -14, 10, -11, 11, -2, 4, -1, 1, 3, 7, 3, 14, 0, 11, 0, 15, -5, 9, -4, 12, -2, -4, -1, -14, 4, 11, 6, 14, -14, -10, -11, -11, 12, -13, 15, -11, -5, 5, -4, 8, -12, 2, -11, 14, -2, 0, -2, 4, -12, 8, -11, 4, 3, -10, 5, 8, 11, -6, 14, -4, -1, 4, 0, 7, 3, -1, 3, 3, 9, 7, 10, 15, -2, -2, -1, -8, 11, 1, 14, -1, 2, 2, 3, -1, 11, -4, 12, -13, -14, -4, -13, 0, 7, 7, 9, -4, -2, 7, -1, 10, -12, 12, -10, 15, 7, -12, 10, -14, -13, -14, -11, -11, -9, 13, -6, 11, 10, -10, 13, -9, -7, 9, -4, -4, 9, 4, 12, 6, -11, 3, -8, 4, -14, 10, -13, 6, 9, 8, 12, 9, 7, 5, 10, 9, 6, 4, 8, 7, -3, -1, -2, -4, 15, -6, 15, -2, 9, -14, 15, 12, -9, -14, -6, -13, 6, -14, 8, -11, 10, 8, 13, 7, -12, 4, -9, 7, 10, 6, 13, 3, -10, -1, -9, -14, -13, -2, -8, 4, 8, 13, 10, 10, -12, -3, -9, -5, 10, 1, 10, 6, 11, -14, 15, 0, 7, -10, 9, -7, -8, 1, -6, -2, -9, 5, -7, 8, -10, 1, -7, 0, -10, -14, -9, -10, -13, 12, -9, 12, -9, -4, -6, -3, -9, 8, -7, 11, 13, 4, 14, 7, 8, -2, 11, -5, -2, -8, 1, 10, -13, 8, -8, -6, -11, -8, -10, -5, -8, -2, -6, 15, 6, 0, 8, 3, -12, -13, -4, -2, -7, -8, -3, 12, 3, 0, 8, -14, 11, -2, 11, 2, 9, 12, 12, 11, 4, 15, 6, 12, 7, -9, 10, -10, -14, 12, -13, 9, -4, 15, 0, -1, 14, 2, 14, 15, -8, -9, -6, -12, -8, -3, -5, -1, -14, -9, -13, -6, 6, 9, 8, 6, -12, -9, -9, -12, 6, 7, 6, 11, 7, 11, 10, 12, -9, -6, -7, -9, 5, -8, 8, -11, -14, 10, -6, 3, 5, 11, 5, 15, 9, 2, 12, 0, 5, 7, 10, 15, 7, -14, 10, -13, 10, 0, 14, 0, 13, -8, 14, -11, 5, -7, 10, 9, 1, 5, 5, 15, -5, -11, -2, -8, -2, -11, 2, 2, -14, -12, -8, -11, -9, 4, -6, 5, 2, 2, 4, 7, -9, -5, -4, 4, 5, -5, 8, -8, -10, 11, -7, 13, 0, 7, 2, 3, -9, -12, -6, -14, 9, -3, 13, -4, -13, 7, -8, 8, -6, -14, 0, 14, -8, 13, -5, 14, 4, 13, 7, -5, -4, -9, -2, -12, 7, -5, 10, -2, -7, -10, -7, -6, -7, -8, -4, -7, -7, 7, -4, 6, -2, 15, 2, -13, 5, -14, 9, 0, 10, 15, 15, 10, -4, -14, -1, -13, 7, 1, 10, 3, 1, -5, 3, -2, 4, 7, 7, 10, 0, 2, 2, 5, 6, -10, 9, -9, 7, 4, 10, 1, 0, 7, 2, 10, -8, 12, -3, -11, -2, 1, 0, 4, 3, 4, 5, 1, -2, -5, 0, -9, 6, 11, 9, 10, 4, 8, 11, -13, 4, -11, 7, -9, 3, -10, 6, -11, -1, 14, 2, 11, 6, -4, 9, -5, 2, 13, 5, 14, -1, -10, 2, -13, -7, 1, -4, 3, 4, 10, 7, 11, -1, -11, 2, -8, 6, 0, 9, -3, 7, -4, 15, 6, 4, 12, 7, 10, -1, -2, 1, -5, -6, 15, 0, 5, -7, 9, -4, 11, 7, 6, 11, 7, 6, 7, 9, 6, 5, -7, 8, -5, -14, 0, -7, 14, -3, 14, 0, 15, 6, -7, 15, -13, 11, 11, 11, 15
	//};
	static int learned_orb_pattern_64_fisheyeOCAM_corr21[4 * 512] =
	{
		-7, -1, 7, 0, 6, 1, 6, 15, -9, 15, -8, 4, -2, -9, -2, 1, 6, 11, 15, 14, -3, 3, -2, -4, -11, 8, -2, 5, -3, -14, 0, -7, -6, -5, -4, 6, -8, -14, -8, -1, 2, 8, 3, 0, 7, -1, 8, -14, 2, 3, 3, -3, -4, 14, 0, -13, 2, -4, 3, 4, -7, 7, -5, 14, 3, 15, 4, 7, -9, -3, -6, -11, 5, -14, 5, -3, 11, -9, 15, -14, 3, -14, 9, -13, 13, 9, 15, 15, 8, 12, 9, 2, -9, -13, -3, -11, 13, 3, 14, 9, -2, -1, -2, 7, -1, 5, 1, 13, -14, 2, -8, 0, 13, 1, 15, -5, -14, 6, -13, 0, 5, -8, 11, 3, -9, 2, -9, 10, 12, -3, 15, 3, -14, -3, -11, 3, 10, 5, 15, 1, 14, -12, 14, -4, -6, 7, -5, -2, -11, 2, -10, -7, 9, -13, 15, -11, -14, 9, -13, 15, -2, -5, 2, 0, -10, 15, 2, -4, -6, -9, 1, -10, -13, -3, 1, 8, 0, -10, 3, -4, -3, -12, 6, -13, -6, 9, 1, 14, -1, 15, 5, -6, -5, -14, 12, 15, -5, -3, -2, -10, -6, 1, -3, 10, -8, 0, -3, -4, -3, 9, 15, -12, -3, 15, 4, 13, -2, 3, 3, -11, 3, -8, 5, -1, 0, -9, 12, -3, 0, 10, 7, 10, -2, 0, 1, 8, 3, 10, 5, 3, -1, 12, 1, 6, -6, -9, -1, 15, -3, 5, -2, -1, 3, -3, 6, 3, 1, -14, 5, 10, 1, 13, 15, 5, 5, 7, 7, 0, -8, -8, -4, -14, -5, 15, -1, 10, 8, -1, 14, 15, -9, -10, -2, 0, -3, -7, -1, -14, 9, -3, 15, -10, -11, 15, -2, 15, 1, -4, 7, -9, 10, 5, 10, 12, -3, -1, -2, 5, -10, 2, -5, 7, 4, 15, 11, -6, -6, 3, -5, -8, 9, 5, 15, 8, 8, 9, 9, 15, 12, -3, 13, -14, -14, -11, -10, -4, 7, -1, 7, 8, -14, -14, -12, -8, 9, -13, 9, 1, -14, 10, -12, 4, 7, -1, 14, -3, -10, 9, -8, 0, 4, 0, 4, 10, 0, 7, 1, -6, -14, 15, -12, 9, -12, -3, -6, 15, 9, 0, 10, -6, 3, 8, 3, 15, -7, -6, -7, 1, 6, -14, 10, -8, 7, 15, 9, 8, -14, -4, -4, -7, -14, 12, -3, -11, -13, -7, -12, 0, -13, 13, -8, 8, 3, 0, 4, -14, 7, -8, 11, -13, 6, 3, 12, 7, -11, -6, -7, -1, -10, -14, -7, -8, -4, -14, -4, -7, 3, 12, 9, 15, -13, 9, -5, 13, 2, -4, 2, 15, -1, -10, 0, 10, -13, -14, -9, 7, -2, 0, -1, -6, 9, -8, 9, 15, -4, 9, -3, 2, -13, 15, -12, -6, 0, 0, 0, 13, 4, 10, 5, -8, 6, -7, 6, 1, -14, -14, -9, -10, 1, 3, 15, 12, 3, -11, 3, 2, 10, 8, 13, -12, 15, -1, 15, 6, 10, -6, 15, -2, -13, -2, -12, -13, 5, -3, 10, -9, 2, 15, 3, -13, 13, 15, 14, -1, -4, -11, -4, 5, -2, -3, -2, 13, -13, -13, -6, -13, -6, 15, -5, -7, -14, 3, -14, 11, 7, 8, 12, 2, 4, -7, 4, 9, 3, -9, 7, -14, 8, 6, 9, -2, -5, -1, -5, 8, 9, -3, 9, 4, 5, -3, 5, 4, 6, -14, 13, 12, -9, -1, -8, 5, 13, -8, 13, 2, 10, 14, 14, 7, -14, -8, -9, -13, -13, -1, -13, 7, -14, 5, -9, 9, 4, -4, 8, 12, -5, 12, -4, 6, 6, 2, 7, -4, -2, 8, -2, 15, -8, 4, 3, 0, -8, -10, 4, 0, -12, 3, 4, -5, -4, -3, 2, -5, -9, 7, 9, -8, -12, -6, 7, -7, -5, 10, 4, -4, -6, -5, 5, -11, -6, -9, 11, -4, -4, -14, 6, -2, -14, 1, 11, 5, -10, 14, 8, 5, -7, -4, 3, 10, -9, 3, 11, 14, -2, -6, 4, -3, -8, 8, 5, 10, -10, -1, 15, -6, -7, -5, 14, 8, -10, -13, 8, 6, -6, 9, 13, 2, -9, -3, 1, -5, -8, 1, 2, -12, -3, 5, 6, -7, -5, -8, 7, 11, -3, 14, 9, -1, -12, -1, 5, 13, -2, -7, 9, 3, -3, 5, 3, 7, -5, 2, 4, 15, -1, 5, 3, -1, -4, -10, 4, -8, -13, 9, 3, 5, -1, 9, 6, 3, -4, 1, 0, 6, -13, 0, 9, -14, -5, 0, -1, -6, -5, 15, 3, 3, -5, 8, 5, -13, -9, -13, 9, -11, -7, 15, 5, -9, -8, -1, -1, 5, -14, -11, 15, 0, -5, 12, 9, 12, -14, -12, 3, -6, -14, -7, 2, 0, -8, 3, 0, 11, -3, -5, 10, -10, -6, 9, 1, 7, -2, -14, 3, -1, -1, 4, 7, -2, -4, 5, 2, -9, -4, -11, 3, 8, -2, 11, 4, 7, -11, 11, 15, 10, -13, -4, 2, -10, 0, -12, 6, 3, -1, -9, 7, -6, -9, 7, 1, -8, -14, 10, 5, -12, -14, 10, 7, 15, 0, 13, 4, 1, -7, 14, 14, -7, -11, -10, 4, -13, -2, 4, 6, 8, -3, -12, 14, 2, 1, -5, 5, 1, -8, -13, 4, 13, -3, -1, 15, -3, -10, -4, 1, 15, -2, 7, 11, 8, 0, 4, 3, -2, -2, -5, 4, 9, -10, 15, 3, 12, -5, -9, 0, -5, -1, 10, 9, -6, -12, 6, 2, 15, -2, -14, 9, -9, -6, 5, -2, -4, -7, -8, 0, 8, -14, 1, 0, -5, -1, 11, 2, 0, -5, -14, 3, -12, 2, 15, 6, 0, 1, -7, 3, -1, -7, -6, 0, -14, -7, 1, -3, -9, -4, 14, 9, -13, -2, 9, 4, 12, -3, -6, 1, -11, 0, 15, 7, 7, 2, 7, 4, 0, -4, -11, 15, -14, -3, -2, 15, 15, -9, 9, 0, 3, -5, 0, -1, 15, -3, 14, 14, 8, -4, -10, 2, -14, -4, -4, -2, 5, 1, 9, 10, 2, -2, 0, 1, -6, -14, 3, 1, -13, 2, -14, 9, -2, -8, -5, -2, -9, -4, 0, 0, -14, 2, 10, 6, -3, 0, -14, 4, -7, -4, 9, 0, -6, -6, 6, -1, -12, -1, -5, 4, -9, -9, 12, 2, -14, -10, 10, 0, 11, -1, -11, 10, 9, -3, -7, 3, 14, -7, 0, -4, 6, -10, 0, -2, -14, -2, 6, 8, 15, -3, 5, 0, 11, -9, -13, 0, -6, -6, -13, 0, 4, -11, 0, -2, 12, -13, -12, 1, 11, 2, -13, 4, -1, -2, 11, 3, -10, -11, -7, -1, -6, -1, 11, 2, -4, -9, 3, -3, 5, -2, 4, 8, -14, -4, -4, -1, 11, -9, 15, 0, 6, 3, -9, 8, 2, -2, -12, 6, 15, -8, 8, -2, 14, -1, 15, 7, 15, -2, -9, 0, -3, 0, 15, 13, -4, -8, 0, -4, 15, 0, 8, 5, -9, -1, -4, 14, 5, -7, -13, 0, -14, 2, -5, 8, -3, -13, 5, -1, 10, 0, 15, 3, 9, -10, -9, -1, -12, -2, -7, 1, 6, -7, -5, -3, 12, -11, 6, -2, -4, -6, -1, -4, -13, 1, 5, 8, 6, 1, -8, 6, 8, -1, 12, 12, 14, 0, -10, 3, 6, -11, -6, -2, 5, -1, -8, 4, -13, -12, 0, -2, 2, 3, -11, 5, -5, 4, -13, 6, 2, -2, 0, 4, 14, 3, 15, 10, 5, -3, -14, 2, 13, -8, 5, -4, 10, 0, 4, 12, -5, 0, -10, 8, -12, -7, 11, -2, -4, 0, -14, 15, -7, -3, 2, -1, -8, 5, 12, 7, 1, -2, -3, 0, -9, -2, 4, -1, -3, -5, 5, -3, 12, 3, -6, 4, 0, -5, -6, -3, 2, 3, -14, 7, -9, 1, 15, 8, -10, -7, 1, -5, -5, -3, 15, 0, -4, -12, 2, -3, -9, 3, 15, 4, 0, -14, 13, -1, -2, -7, 15, -1, 14, -8, 8, -3, -9, -2, 9, 1, 15, 4, 8, 5, 0, -11, -3, -3, -3, -9, 5, -4, -14, 5, -10, 7, -3, -7, -13, -1, 11, 4, 4, 7, -2, -4, 8, -2, 14, 5, 15, 6, 4, 2, 14, 9, 11, 2, -14, 13, 5, 4, 5, 5, -1, 2, 10, 3, 3, -12, 5, -3, 15, 0, -7, 9, 14, -3, 15, 0, 7, -12, -7, -2, 14, -5, 4, -4, -2, 4, 15, 6, -5, -4, -9, -2, 6, 0, -8, 14, -10, -12, -5, -3, -11, 9, 0, 9, 15, 0, 3, 4, 8, 3, -10, 9, -7, 8, 4, 11, 15, 4, 12, 11, 0, 8, 1, 13, -14, 10, 3, 15, 12, -4, 0, -3, -6, 7, 4, 7, 11, -9, -2, -5, 10, -5, 11, -2, 5, 1, 8, 10, -11, 0, 10, 4, 15, 6, -14, 10, -1, 1, -3, 3, 7, 1, 6, 5, 11, 2, -5, 10, 7, 0, 3, 5, -11, -7, -14, -7, -6, 3, 12, 4, 5, -13, -14, -8, 0, 4, 3, 4, 15, 3, -13, 4, -7, -14, -1, -3, 8, -4, 1, -3, 7, -13, 15, -8, 1, -8, -2, -5, 4, 9, -5, 10, -14, 6, 7, 6, 14, -7, 2, -6, 11, 7, 15, 8, -2, 3, -10, 4, 4, -4, -10, -2, -4, 0, -11, 1, -5, 2, 10, 3, -3, 9, 2, 13, 7, -3, 6, -2, -7, 1, 15, 2, 3, 9, 2, 10, 10, 0, 4, 2, -8, -9, -9, -3, 9, 4, -5, 5, 2, -1, -14, 1, 6, 3, 9, 9, 8, 10, -6, 13, -12, 0, 5, 1, -1, -11, 13, -2, 9, -2, 8, 1, -14, 4, -4, 9, 0, 7, -3, 7, 13, 10, 7, 14, 15, -8, 2, -7, -14, -7, -2, -6, -8, -4, -3, -3, 8, -4, 7, -3, -4, 12, 3, 14, 15, -14, -13, -2, -4, 9, -3, 10, -10, 3, 7, 4, -5, 8, 1, 15, -7, -6, -10, -6, -3, 13, -4, 15, -10, 9, 1, 15, 3, 0, -14, 1, 0, 4, -12, 8, 7, 6, -14, 7, -7, -10, -12, -9, -5, 1, 7, 10, 12, 2, 6, 14, 2, 6, 0, 9, 14, 1, -5, 2, 3, 6, 2, 6, 9, -10, 2, -4, -1, -7, -6, -6, -14, -1, 14, 1, -8, 1, -9, 15, 10, -8, 13, -7, -1, -8, 4, -7, 15, -1, 3, 1, 10, 5, 10, 8, -4, -13, -1, -5, -14, 7, -8, 8, -14, -1, -4, 2, -13, -11, -13, -11, -1, -14, -8, -9, -1, -10, -9, -9, -3, -13, 9, -9, 3, 2, -8, 15, 1, 4, -12, 12, -4, -4, 3, -3, -10, -7, -4, -6, 15, -8, 15, -2, -11, 12, 1, 15, 7, 6, -7, 8, -1, -10, -1, -5, -5, 12, 1, 15, -11, 5, -5, 5, 15, -5, -14, -5, 1, 2, 15, 15, 13, 10, 11, 15, 15, 1, 15, 2, -4, 2, 1, 8, 0, -14, 4, -3, 4, -10, 15, -9, 9, 0, -7, 2, 10, -10, 11, -4, 14, -12, 14, -11, 4, 12, -8, 13, -14, -3, 3, -2, 9, 11, 8, 11, 15, -7, -10, -3, -5, -8, -6, -4, 1, -7, 6, -4, 0, 6, 4, 15, 13, -4, 12, -2, -7, 8, 1, 10, 7, -4, 0, -3, 12, 7, 2, 8, -10, 11, -2, 12, 12, -13, -10, -3, -9, -9, -9, -9, 1, -2, -2, 0, 12, 2, 10, 15, -6, -11, 3, -6, 12, -4, -6, -3, -12, -14, 11, -10, -2, 7, -3, 15, 9, 5, 0, 15, -14, -14, 6, -10, 0, 7, -10, 7, -1, 5, -9, 6, 4, 2, -14, 11, 15, 14, 5, 15, 11, -7, -12, -3, 5, -8, 4, -5, -3, 9, -4, 15, -5, -2, 2, 0, -12, -13, -12, -12, -5, -7, -13, -7, 5, 5, 3, 6, -14, -5, 10, -3, -12, -14, 15, -10, 10, 1, 10, 5, -14, 7, 9, 8, -1, 5, -5, 6, -14, 9, -8, 15, -11, 9, -14, 9, -5, 14, -6, 15, -12, 7, 15, 12, 2, -14, -9, -13, -3, -14, -3, -8, 0, 7, -4, 12, -8, -4, -7, -3, 10, 11, 2, 15, -3, -1, 2, 0, -4, 5, 0, 5, 7
	};
	static int bit_pattern_31_[256 * 4] =
	{
		8, -3, 9, 5/*mean (0), correlation (0)*/,
		4, 2, 7, -12/*mean (1.12461e-05), correlation (0.0437584)*/,
		-11, 9, -8, 2/*mean (3.37382e-05), correlation (0.0617409)*/,
		7, -12, 12, -13/*mean (5.62303e-05), correlation (0.0636977)*/,
		2, -13, 2, 12/*mean (0.000134953), correlation (0.085099)*/,
		1, -7, 1, 6/*mean (0.000528565), correlation (0.0857175)*/,
		-2, -10, -2, -4/*mean (0.0188821), correlation (0.0985774)*/,
		-13, -13, -11, -8/*mean (0.0363135), correlation (0.0899616)*/,
		-13, -3, -12, -9/*mean (0.121806), correlation (0.099849)*/,
		10, 4, 11, 9/*mean (0.122065), correlation (0.093285)*/,
		-13, -8, -8, -9/*mean (0.162787), correlation (0.0942748)*/,
		-11, 7, -9, 12/*mean (0.21561), correlation (0.0974438)*/,
		7, 7, 12, 6/*mean (0.160583), correlation (0.130064)*/,
		-4, -5, -3, 0/*mean (0.228171), correlation (0.132998)*/,
		-13, 2, -12, -3/*mean (0.00997526), correlation (0.145926)*/,
		-9, 0, -7, 5/*mean (0.198234), correlation (0.143636)*/,
		12, -6, 12, -1/*mean (0.0676226), correlation (0.16689)*/,
		-3, 6, -2, 12/*mean (0.166847), correlation (0.171682)*/,
		-6, -13, -4, -8/*mean (0.101215), correlation (0.179716)*/,
		11, -13, 12, -8/*mean (0.200641), correlation (0.192279)*/,
		4, 7, 5, 1/*mean (0.205106), correlation (0.186848)*/,
		5, -3, 10, -3/*mean (0.234908), correlation (0.192319)*/,
		3, -7, 6, 12/*mean (0.0709964), correlation (0.210872)*/,
		-8, -7, -6, -2/*mean (0.0939834), correlation (0.212589)*/,
		-2, 11, -1, -10/*mean (0.127778), correlation (0.20866)*/,
		-13, 12, -8, 10/*mean (0.14783), correlation (0.206356)*/,
		-7, 3, -5, -3/*mean (0.182141), correlation (0.198942)*/,
		-4, 2, -3, 7/*mean (0.188237), correlation (0.21384)*/,
		-10, -12, -6, 11/*mean (0.14865), correlation (0.23571)*/,
		5, -12, 6, -7/*mean (0.222312), correlation (0.23324)*/,
		5, -6, 7, -1/*mean (0.229082), correlation (0.23389)*/,
		1, 0, 4, -5/*mean (0.241577), correlation (0.215286)*/,
		9, 11, 11, -13/*mean (0.00338507), correlation (0.251373)*/,
		4, 7, 4, 12/*mean (0.131005), correlation (0.257622)*/,
		2, -1, 4, 4/*mean (0.152755), correlation (0.255205)*/,
		-4, -12, -2, 7/*mean (0.182771), correlation (0.244867)*/,
		-8, -5, -7, -10/*mean (0.186898), correlation (0.23901)*/,
		4, 11, 9, 12/*mean (0.226226), correlation (0.258255)*/,
		0, -8, 1, -13/*mean (0.0897886), correlation (0.274827)*/,
		-13, -2, -8, 2/*mean (0.148774), correlation (0.28065)*/,
		-3, -2, -2, 3/*mean (0.153048), correlation (0.283063)*/,
		-6, 9, -4, -9/*mean (0.169523), correlation (0.278248)*/,
		8, 12, 10, 7/*mean (0.225337), correlation (0.282851)*/,
		0, 9, 1, 3/*mean (0.226687), correlation (0.278734)*/,
		7, -5, 11, -10/*mean (0.00693882), correlation (0.305161)*/,
		-13, -6, -11, 0/*mean (0.0227283), correlation (0.300181)*/,
		10, 7, 12, 1/*mean (0.125517), correlation (0.31089)*/,
		-6, -3, -6, 12/*mean (0.131748), correlation (0.312779)*/,
		10, -9, 12, -4/*mean (0.144827), correlation (0.292797)*/,
		-13, 8, -8, -12/*mean (0.149202), correlation (0.308918)*/,
		-13, 0, -8, -4/*mean (0.160909), correlation (0.310013)*/,
		3, 3, 7, 8/*mean (0.177755), correlation (0.309394)*/,
		5, 7, 10, -7/*mean (0.212337), correlation (0.310315)*/,
		-1, 7, 1, -12/*mean (0.214429), correlation (0.311933)*/,
		3, -10, 5, 6/*mean (0.235807), correlation (0.313104)*/,
		2, -4, 3, -10/*mean (0.00494827), correlation (0.344948)*/,
		-13, 0, -13, 5/*mean (0.0549145), correlation (0.344675)*/,
		-13, -7, -12, 12/*mean (0.103385), correlation (0.342715)*/,
		-13, 3, -11, 8/*mean (0.134222), correlation (0.322922)*/,
		-7, 12, -4, 7/*mean (0.153284), correlation (0.337061)*/,
		6, -10, 12, 8/*mean (0.154881), correlation (0.329257)*/,
		-9, -1, -7, -6/*mean (0.200967), correlation (0.33312)*/,
		-2, -5, 0, 12/*mean (0.201518), correlation (0.340635)*/,
		-12, 5, -7, 5/*mean (0.207805), correlation (0.335631)*/,
		3, -10, 8, -13/*mean (0.224438), correlation (0.34504)*/,
		-7, -7, -4, 5/*mean (0.239361), correlation (0.338053)*/,
		-3, -2, -1, -7/*mean (0.240744), correlation (0.344322)*/,
		2, 9, 5, -11/*mean (0.242949), correlation (0.34145)*/,
		-11, -13, -5, -13/*mean (0.244028), correlation (0.336861)*/,
		-1, 6, 0, -1/*mean (0.247571), correlation (0.343684)*/,
		5, -3, 5, 2/*mean (0.000697256), correlation (0.357265)*/,
		-4, -13, -4, 12/*mean (0.00213675), correlation (0.373827)*/,
		-9, -6, -9, 6/*mean (0.0126856), correlation (0.373938)*/,
		-12, -10, -8, -4/*mean (0.0152497), correlation (0.364237)*/,
		10, 2, 12, -3/*mean (0.0299933), correlation (0.345292)*/,
		7, 12, 12, 12/*mean (0.0307242), correlation (0.366299)*/,
		-7, -13, -6, 5/*mean (0.0534975), correlation (0.368357)*/,
		-4, 9, -3, 4/*mean (0.099865), correlation (0.372276)*/,
		7, -1, 12, 2/*mean (0.117083), correlation (0.364529)*/,
		-7, 6, -5, 1/*mean (0.126125), correlation (0.369606)*/,
		-13, 11, -12, 5/*mean (0.130364), correlation (0.358502)*/,
		-3, 7, -2, -6/*mean (0.131691), correlation (0.375531)*/,
		7, -8, 12, -7/*mean (0.160166), correlation (0.379508)*/,
		-13, -7, -11, -12/*mean (0.167848), correlation (0.353343)*/,
		1, -3, 12, 12/*mean (0.183378), correlation (0.371916)*/,
		2, -6, 3, 0/*mean (0.228711), correlation (0.371761)*/,
		-4, 3, -2, -13/*mean (0.247211), correlation (0.364063)*/,
		-1, -13, 1, 9/*mean (0.249325), correlation (0.378139)*/,
		7, 1, 8, -6/*mean (0.000652272), correlation (0.411682)*/,
		1, -1, 3, 12/*mean (0.00248538), correlation (0.392988)*/,
		9, 1, 12, 6/*mean (0.0206815), correlation (0.386106)*/,
		-1, -9, -1, 3/*mean (0.0364485), correlation (0.410752)*/,
		-13, -13, -10, 5/*mean (0.0376068), correlation (0.398374)*/,
		7, 7, 10, 12/*mean (0.0424202), correlation (0.405663)*/,
		12, -5, 12, 9/*mean (0.0942645), correlation (0.410422)*/,
		6, 3, 7, 11/*mean (0.1074), correlation (0.413224)*/,
		5, -13, 6, 10/*mean (0.109256), correlation (0.408646)*/,
		2, -12, 2, 3/*mean (0.131691), correlation (0.416076)*/,
		3, 8, 4, -6/*mean (0.165081), correlation (0.417569)*/,
		2, 6, 12, -13/*mean (0.171874), correlation (0.408471)*/,
		9, -12, 10, 3/*mean (0.175146), correlation (0.41296)*/,
		-8, 4, -7, 9/*mean (0.183682), correlation (0.402956)*/,
		-11, 12, -4, -6/*mean (0.184672), correlation (0.416125)*/,
		1, 12, 2, -8/*mean (0.191487), correlation (0.386696)*/,
		6, -9, 7, -4/*mean (0.192668), correlation (0.394771)*/,
		2, 3, 3, -2/*mean (0.200157), correlation (0.408303)*/,
		6, 3, 11, 0/*mean (0.204588), correlation (0.411762)*/,
		3, -3, 8, -8/*mean (0.205904), correlation (0.416294)*/,
		7, 8, 9, 3/*mean (0.213237), correlation (0.409306)*/,
		-11, -5, -6, -4/*mean (0.243444), correlation (0.395069)*/,
		-10, 11, -5, 10/*mean (0.247672), correlation (0.413392)*/,
		-5, -8, -3, 12/*mean (0.24774), correlation (0.411416)*/,
		-10, 5, -9, 0/*mean (0.00213675), correlation (0.454003)*/,
		8, -1, 12, -6/*mean (0.0293635), correlation (0.455368)*/,
		4, -6, 6, -11/*mean (0.0404971), correlation (0.457393)*/,
		-10, 12, -8, 7/*mean (0.0481107), correlation (0.448364)*/,
		4, -2, 6, 7/*mean (0.050641), correlation (0.455019)*/,
		-2, 0, -2, 12/*mean (0.0525978), correlation (0.44338)*/,
		-5, -8, -5, 2/*mean (0.0629667), correlation (0.457096)*/,
		7, -6, 10, 12/*mean (0.0653846), correlation (0.445623)*/,
		-9, -13, -8, -8/*mean (0.0858749), correlation (0.449789)*/,
		-5, -13, -5, -2/*mean (0.122402), correlation (0.450201)*/,
		8, -8, 9, -13/*mean (0.125416), correlation (0.453224)*/,
		-9, -11, -9, 0/*mean (0.130128), correlation (0.458724)*/,
		1, -8, 1, -2/*mean (0.132467), correlation (0.440133)*/,
		7, -4, 9, 1/*mean (0.132692), correlation (0.454)*/,
		-2, 1, -1, -4/*mean (0.135695), correlation (0.455739)*/,
		11, -6, 12, -11/*mean (0.142904), correlation (0.446114)*/,
		-12, -9, -6, 4/*mean (0.146165), correlation (0.451473)*/,
		3, 7, 7, 12/*mean (0.147627), correlation (0.456643)*/,
		5, 5, 10, 8/*mean (0.152901), correlation (0.455036)*/,
		0, -4, 2, 8/*mean (0.167083), correlation (0.459315)*/,
		-9, 12, -5, -13/*mean (0.173234), correlation (0.454706)*/,
		0, 7, 2, 12/*mean (0.18312), correlation (0.433855)*/,
		-1, 2, 1, 7/*mean (0.185504), correlation (0.443838)*/,
		5, 11, 7, -9/*mean (0.185706), correlation (0.451123)*/,
		3, 5, 6, -8/*mean (0.188968), correlation (0.455808)*/,
		-13, -4, -8, 9/*mean (0.191667), correlation (0.459128)*/,
		-5, 9, -3, -3/*mean (0.193196), correlation (0.458364)*/,
		-4, -7, -3, -12/*mean (0.196536), correlation (0.455782)*/,
		6, 5, 8, 0/*mean (0.1972), correlation (0.450481)*/,
		-7, 6, -6, 12/*mean (0.199438), correlation (0.458156)*/,
		-13, 6, -5, -2/*mean (0.211224), correlation (0.449548)*/,
		1, -10, 3, 10/*mean (0.211718), correlation (0.440606)*/,
		4, 1, 8, -4/*mean (0.213034), correlation (0.443177)*/,
		-2, -2, 2, -13/*mean (0.234334), correlation (0.455304)*/,
		2, -12, 12, 12/*mean (0.235684), correlation (0.443436)*/,
		-2, -13, 0, -6/*mean (0.237674), correlation (0.452525)*/,
		4, 1, 9, 3/*mean (0.23962), correlation (0.444824)*/,
		-6, -10, -3, -5/*mean (0.248459), correlation (0.439621)*/,
		-3, -13, -1, 1/*mean (0.249505), correlation (0.456666)*/,
		7, 5, 12, -11/*mean (0.00119208), correlation (0.495466)*/,
		4, -2, 5, -7/*mean (0.00372245), correlation (0.484214)*/,
		-13, 9, -9, -5/*mean (0.00741116), correlation (0.499854)*/,
		7, 1, 8, 6/*mean (0.0208952), correlation (0.499773)*/,
		7, -8, 7, 6/*mean (0.0220085), correlation (0.501609)*/,
		-7, -4, -7, 1/*mean (0.0233806), correlation (0.496568)*/,
		-8, 11, -7, -8/*mean (0.0236505), correlation (0.489719)*/,
		-13, 6, -12, -8/*mean (0.0268781), correlation (0.503487)*/,
		2, 4, 3, 9/*mean (0.0323324), correlation (0.501938)*/,
		10, -5, 12, 3/*mean (0.0399235), correlation (0.494029)*/,
		-6, -5, -6, 7/*mean (0.0420153), correlation (0.486579)*/,
		8, -3, 9, -8/*mean (0.0548021), correlation (0.484237)*/,
		2, -12, 2, 8/*mean (0.0616622), correlation (0.496642)*/,
		-11, -2, -10, 3/*mean (0.0627755), correlation (0.498563)*/,
		-12, -13, -7, -9/*mean (0.0829622), correlation (0.495491)*/,
		-11, 0, -10, -5/*mean (0.0843342), correlation (0.487146)*/,
		5, -3, 11, 8/*mean (0.0929937), correlation (0.502315)*/,
		-2, -13, -1, 12/*mean (0.113327), correlation (0.48941)*/,
		-1, -8, 0, 9/*mean (0.132119), correlation (0.467268)*/,
		-13, -11, -12, -5/*mean (0.136269), correlation (0.498771)*/,
		-10, -2, -10, 11/*mean (0.142173), correlation (0.498714)*/,
		-3, 9, -2, -13/*mean (0.144141), correlation (0.491973)*/,
		2, -3, 3, 2/*mean (0.14892), correlation (0.500782)*/,
		-9, -13, -4, 0/*mean (0.150371), correlation (0.498211)*/,
		-4, 6, -3, -10/*mean (0.152159), correlation (0.495547)*/,
		-4, 12, -2, -7/*mean (0.156152), correlation (0.496925)*/,
		-6, -11, -4, 9/*mean (0.15749), correlation (0.499222)*/,
		6, -3, 6, 11/*mean (0.159211), correlation (0.503821)*/,
		-13, 11, -5, 5/*mean (0.162427), correlation (0.501907)*/,
		11, 11, 12, 6/*mean (0.16652), correlation (0.497632)*/,
		7, -5, 12, -2/*mean (0.169141), correlation (0.484474)*/,
		-1, 12, 0, 7/*mean (0.169456), correlation (0.495339)*/,
		-4, -8, -3, -2/*mean (0.171457), correlation (0.487251)*/,
		-7, 1, -6, 7/*mean (0.175), correlation (0.500024)*/,
		-13, -12, -8, -13/*mean (0.175866), correlation (0.497523)*/,
		-7, -2, -6, -8/*mean (0.178273), correlation (0.501854)*/,
		-8, 5, -6, -9/*mean (0.181107), correlation (0.494888)*/,
		-5, -1, -4, 5/*mean (0.190227), correlation (0.482557)*/,
		-13, 7, -8, 10/*mean (0.196739), correlation (0.496503)*/,
		1, 5, 5, -13/*mean (0.19973), correlation (0.499759)*/,
		1, 0, 10, -13/*mean (0.204465), correlation (0.49873)*/,
		9, 12, 10, -1/*mean (0.209334), correlation (0.49063)*/,
		5, -8, 10, -9/*mean (0.211134), correlation (0.503011)*/,
		-1, 11, 1, -13/*mean (0.212), correlation (0.499414)*/,
		-9, -3, -6, 2/*mean (0.212168), correlation (0.480739)*/,
		-1, -10, 1, 12/*mean (0.212731), correlation (0.502523)*/,
		-13, 1, -8, -10/*mean (0.21327), correlation (0.489786)*/,
		8, -11, 10, -6/*mean (0.214159), correlation (0.488246)*/,
		2, -13, 3, -6/*mean (0.216993), correlation (0.50287)*/,
		7, -13, 12, -9/*mean (0.223639), correlation (0.470502)*/,
		-10, -10, -5, -7/*mean (0.224089), correlation (0.500852)*/,
		-10, -8, -8, -13/*mean (0.228666), correlation (0.502629)*/,
		4, -6, 8, 5/*mean (0.22906), correlation (0.498305)*/,
		3, 12, 8, -13/*mean (0.233378), correlation (0.503825)*/,
		-4, 2, -3, -3/*mean (0.234323), correlation (0.476692)*/,
		5, -13, 10, -12/*mean (0.236392), correlation (0.475462)*/,
		4, -13, 5, -1/*mean (0.236842), correlation (0.504132)*/,
		-9, 9, -4, 3/*mean (0.236977), correlation (0.497739)*/,
		0, 3, 3, -9/*mean (0.24314), correlation (0.499398)*/,
		-12, 1, -6, 1/*mean (0.243297), correlation (0.489447)*/,
		3, 2, 4, -8/*mean (0.00155196), correlation (0.553496)*/,
		-10, -10, -10, 9/*mean (0.00239541), correlation (0.54297)*/,
		8, -13, 12, 12/*mean (0.0034413), correlation (0.544361)*/,
		-8, -12, -6, -5/*mean (0.003565), correlation (0.551225)*/,
		2, 2, 3, 7/*mean (0.00835583), correlation (0.55285)*/,
		10, 6, 11, -8/*mean (0.00885065), correlation (0.540913)*/,
		6, 8, 8, -12/*mean (0.0101552), correlation (0.551085)*/,
		-7, 10, -6, 5/*mean (0.0102227), correlation (0.533635)*/,
		-3, -9, -3, 9/*mean (0.0110211), correlation (0.543121)*/,
		-1, -13, -1, 5/*mean (0.0113473), correlation (0.550173)*/,
		-3, -7, -3, 4/*mean (0.0140913), correlation (0.554774)*/,
		-8, -2, -8, 3/*mean (0.017049), correlation (0.55461)*/,
		4, 2, 12, 12/*mean (0.01778), correlation (0.546921)*/,
		2, -5, 3, 11/*mean (0.0224022), correlation (0.549667)*/,
		6, -9, 11, -13/*mean (0.029161), correlation (0.546295)*/,
		3, -1, 7, 12/*mean (0.0303081), correlation (0.548599)*/,
		11, -1, 12, 4/*mean (0.0355151), correlation (0.523943)*/,
		-3, 0, -3, 6/*mean (0.0417904), correlation (0.543395)*/,
		4, -11, 4, 12/*mean (0.0487292), correlation (0.542818)*/,
		2, -4, 2, 1/*mean (0.0575124), correlation (0.554888)*/,
		-10, -6, -8, 1/*mean (0.0594242), correlation (0.544026)*/,
		-13, 7, -11, 1/*mean (0.0597391), correlation (0.550524)*/,
		-13, 12, -11, -13/*mean (0.0608974), correlation (0.55383)*/,
		6, 0, 11, -13/*mean (0.065126), correlation (0.552006)*/,
		0, -1, 1, 4/*mean (0.074224), correlation (0.546372)*/,
		-13, 3, -9, -2/*mean (0.0808592), correlation (0.554875)*/,
		-9, 8, -6, -3/*mean (0.0883378), correlation (0.551178)*/,
		-13, -6, -8, -2/*mean (0.0901035), correlation (0.548446)*/,
		5, -9, 8, 10/*mean (0.0949843), correlation (0.554694)*/,
		2, 7, 3, -9/*mean (0.0994152), correlation (0.550979)*/,
		-1, -6, -1, -1/*mean (0.10045), correlation (0.552714)*/,
		9, 5, 11, -2/*mean (0.100686), correlation (0.552594)*/,
		11, -3, 12, -8/*mean (0.101091), correlation (0.532394)*/,
		3, 0, 3, 5/*mean (0.101147), correlation (0.525576)*/,
		-1, 4, 0, 10/*mean (0.105263), correlation (0.531498)*/,
		3, -6, 4, 5/*mean (0.110785), correlation (0.540491)*/,
		-13, 0, -10, 5/*mean (0.112798), correlation (0.536582)*/,
		5, 8, 12, 11/*mean (0.114181), correlation (0.555793)*/,
		8, 9, 9, -6/*mean (0.117431), correlation (0.553763)*/,
		7, -4, 8, -12/*mean (0.118522), correlation (0.553452)*/,
		-10, 4, -10, 9/*mean (0.12094), correlation (0.554785)*/,
		7, 3, 12, 4/*mean (0.122582), correlation (0.555825)*/,
		9, -7, 10, -2/*mean (0.124978), correlation (0.549846)*/,
		7, 0, 12, -2/*mean (0.127002), correlation (0.537452)*/,
		-1, -6, 0, -11/*mean (0.127148), correlation (0.547401)*/
	};
	class ExtractorNode_mdbrief
	{
	public:
		ExtractorNode_mdbrief() :bNoMore(false){}

		void DivideNode(ExtractorNode_mdbrief &n1,
			ExtractorNode_mdbrief &n2,
			ExtractorNode_mdbrief &n3,
			ExtractorNode_mdbrief &n4);

		std::vector<cv::KeyPoint> vKeys;
		cv::Point2i UL, UR, BL, BR;
		std::list<ExtractorNode_mdbrief>::iterator lit;
		bool bNoMore;
	};


	class mdBRIEFextractorOct
	{
	public:

		enum { HARRIS_SCORE = 0, FAST_SCORE = 1 };

		mdBRIEFextractorOct(int _nfeatures = 1000,
			float _scaleFactor = 1.2,
			int _nlevels = 8,
			int _edgeThreshold = 25,
			int _firstLevel = 0,
			int _scoreType = HARRIS_SCORE,
			int _patchSize = 32,
			int _fastThreshold = 20,
			int _minThreshold = 7,
			bool _useAgast = false,
			int _fastAgastType = 2,
			bool _do_dBrief = false,
			bool _learnMasks = false,
			int _descSize = 32);

		~mdBRIEFextractorOct(){}

		void operator()(
			const std::vector<cv::Mat>& _image,
			std::vector<cCamModelGeneral_>& _camModel,
			std::vector<std::vector<cv::KeyPoint> >& _keypoints,
			std::vector<cv::Mat>& _descriptors,
			std::vector<cv::Mat>& _descriptorMasks
			);

		int inline GetLevels(){ return numlevels; }

		double inline GetScaleFactor() { return scaleFactor; }

		bool GetMasksLearned() { return learnMasks; }
		int GetDescriptorSize() { return descSize; }

		// I assume all frames are of the same dimension
		bool mvImagePyramidAllocatedFlag;
		std::vector<cv::Mat> mvMaskPyramid;
		std::vector<cv::cuda::GpuMat> mvMultiImagePyramid;
		std::vector<cv::cuda::GpuMat> mvMultiImagePyramidBorder;

	protected:
		void ComputePyramid(std::vector<cv::Mat> image, cv::Mat *Mask);

		void ComputeKeyPointsOctTree(
			std::vector<std::vector<cv::KeyPoint> > *allKeypoints,
			std::vector<std::vector<cv::KeyPoint*> > &keypoints_mul_GPU,
			cv::Mat *Mask);

		std::vector<cv::KeyPoint> DistributeOctTree(
			const std::vector<cv::KeyPoint>& vToDistributeKeys,
			const int &minX,
			const int &maxX,
			const int &minY,
			const int &maxY,
			const int &nFeatures,
			const int &level);

		void ComputeKeyPointsOld(
			std::vector<std::vector<cv::KeyPoint> >& allKeypoints);

		std::vector<cv::Point> pattern;
		cv::Ptr<cv::cuda::Filter> mpGaussianFilter;
		cv::cuda::Stream mcvStream[8];

		// returns the descriptor size in bytes
		int descriptorSize() const;
		// returns the descriptor type
		int descriptorType() const;
		// returns the default norm type
		int defaultNorm() const;

		int nfeatures;
		double scaleFactor;
		int numlevels;
		int edgeThreshold;
		int firstLevel;
		int descSize;
		int scoreType;
		int patchSize;
		int fastThreshold;
		int minThreshold;
		bool useAgast;
		int fastAgastType;
		bool learnMasks;
		bool do_dBrief;
		
		int minBordersX[8];
		int maxBordersX[8];
		int minBordersY[8];
		int maxBordersY[8];

		std::vector<int> mnFeaturesPerLevel;

		std::vector<int> umax;

		std::vector<double> mvScaleFactor;
		std::vector<double> mvInvScaleFactor;

		ORB_SLAM2::cuda::GpuFast gpuFast;
		ORB_SLAM2::cuda::IC_Angle ic_angle;
		ORB_SLAM2::cuda::GpuOrb gpuOrb;
	};

}
#endif

